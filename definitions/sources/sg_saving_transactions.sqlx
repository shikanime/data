config {
  type: "view",
  database: "shikanime-studio-labs",
  schema: "seeker",
  name: "sg_saving_transactions",
  columns: {
    time: "The date when the transaction occurred",
    account: "The account where the transaction occurred",
    label: "The transaction label or category",
    description: "Detailed description of the transaction",
    change: "The transaction amount",
    symbol: "The currency or asset symbol of the transaction",
    source: "The source of the transaction"
  },
  assertions: {
    nonNull: [
      "time",
      "account",
      "label",
      "change",
      "symbol",
      "source"
    ]
  }
}

SELECT
  TIMESTAMP(PARSE_DATE('%d/%m/%Y', date_comptabilisation), 'Europe/Paris') AS time,
  account,
  libelle_complet_operation AS label,
  montant_operation AS change,
  devise AS symbol,
  "sg" AS source
FROM
  ${ref("sg_saving_transactions_source")}
